{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\haenee\\\\Desktop\\\\naver-map-chat\\\\frontend\\\\src\\\\components\\\\NaverMap.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport './NaverMap.css';\nimport DirectionsSearch from './DirectionsSearch';\nimport DirectionsResult from './DirectionsResult';\nimport './DirectionsSearch.css';\nimport './DirectionsResult.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NaverMap = ({\n  searchResult,\n  userLocation\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const markerRef = useRef(null);\n  const userMarkerRef = useRef(null);\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const [mapError, setMapError] = useState(null);\n\n  // 길찾기 관련 상태\n  const [directions, setDirections] = useState(null);\n  const [directionsPolyline, setDirectionsPolyline] = useState(null);\n  const [showDirectionsPanel, setShowDirectionsPanel] = useState(false);\n  const [directionsMarkers, setDirectionsMarkers] = useState([]);\n  const [startPoint, setStartPoint] = useState(null);\n  const [endPoint, setEndPoint] = useState(null);\n  const polylineRef = useRef(null);\n\n  // 사용자 위치 마커 업데이트\n  const updateUserLocationMarker = useCallback(() => {\n    if (!mapInstanceRef.current || !userLocation) return;\n    const position = new window.naver.maps.LatLng(userLocation.lat, userLocation.lng);\n\n    // 이전 사용자 위치 마커 제거\n    if (userMarkerRef.current) {\n      userMarkerRef.current.setMap(null);\n    }\n\n    // 사용자 위치 마커 생성\n    userMarkerRef.current = new window.naver.maps.Marker({\n      position,\n      map: mapInstanceRef.current,\n      icon: {\n        content: '<div class=\"user-location-marker\"></div>',\n        anchor: new window.naver.maps.Point(15, 15)\n      },\n      title: '내 위치'\n    });\n\n    // 검색 결과가 없을 때만 사용자 위치로 지도 이동\n    if (!searchResult && !showDirectionsPanel) {\n      mapInstanceRef.current.setCenter(position);\n      mapInstanceRef.current.setZoom(16);\n    }\n  }, [userLocation, searchResult, showDirectionsPanel]);\n\n  // 경로 지우기\n  const clearDirections = useCallback(() => {\n    if (directionsPolyline) {\n      directionsPolyline.setMap(null);\n      setDirectionsPolyline(null);\n    }\n    directionsMarkers.forEach(marker => {\n      marker.setMap(null);\n    });\n    setDirectionsMarkers([]);\n  }, [directionsPolyline, directionsMarkers]);\n\n  // 지도 결과 업데이트 함수\n  const updateMapWithSearchResult = useCallback(() => {\n    if (!searchResult || !mapInstanceRef.current) return;\n\n    // 기존 길찾기 정보 제거\n    clearDirections();\n\n    // 길찾기 결과인 경우\n    if (searchResult.status === 'DIRECTIONS_RESULT' && searchResult.directions) {\n      displayDirections(searchResult);\n      return;\n    }\n\n    // 일반 검색 결과 처리 (기존 코드)\n    const {\n      x,\n      y,\n      address,\n      query,\n      additionalInfo\n    } = searchResult;\n    if (!x || !y) return;\n    const position = new window.naver.maps.LatLng(y, x);\n\n    // 지도 중심 이동\n    mapInstanceRef.current.setCenter(position);\n    mapInstanceRef.current.setZoom(16);\n\n    // 이전 마커 제거\n    if (markerRef.current) {\n      markerRef.current.setMap(null);\n    }\n\n    // 새 마커 생성\n    markerRef.current = new window.naver.maps.Marker({\n      position,\n      map: mapInstanceRef.current,\n      title: query\n    });\n\n    // 정보 창 생성\n    const infoWindow = new window.naver.maps.InfoWindow({\n      content: `\n        <div class=\"info-window\">\n          <h3>${query}</h3>\n          <p>${address}</p>\n          ${additionalInfo ? `\n            <div class=\"additional-info\">\n              <p class=\"info-title\">추가 정보</p>\n              <p class=\"info-content\">${additionalInfo}</p>\n            </div>\n          ` : ''}\n        </div>\n      `,\n      maxWidth: 300,\n      backgroundColor: \"#fff\",\n      borderColor: \"#5347AA\",\n      borderWidth: 2,\n      anchorSize: new window.naver.maps.Size(10, 10),\n      anchorColor: \"#fff\",\n      pixelOffset: new window.naver.maps.Point(10, -10)\n    });\n\n    // 마커 클릭 시 정보 창 표시\n    window.naver.maps.Event.addListener(markerRef.current, 'click', () => {\n      if (infoWindow.getMap()) {\n        infoWindow.close();\n      } else {\n        infoWindow.open(mapInstanceRef.current, markerRef.current);\n      }\n    });\n\n    // 정보 창 자동 표시\n    infoWindow.open(mapInstanceRef.current, markerRef.current);\n  }, [searchResult, clearDirections]);\n\n  // 길찾기 결과 표시\n  const displayDirections = useCallback(result => {\n    if (!mapInstanceRef.current || !result.directions || !result.directions.route) return;\n    const {\n      directions,\n      start_location,\n      end_location\n    } = result;\n\n    // 경로가 있는지 확인\n    if (directions.route && directions.route.traoptimal && directions.route.traoptimal[0]) {\n      const pathCoordinates = directions.route.traoptimal[0].path;\n\n      // 기존 경로 제거\n      clearDirections();\n\n      // 새 경로 그리기\n      const path = pathCoordinates.map(coord => new window.naver.maps.LatLng(coord[1], coord[0]));\n      const polyline = new window.naver.maps.Polyline({\n        map: mapInstanceRef.current,\n        path: path,\n        strokeColor: '#5347AA',\n        strokeWeight: 5,\n        strokeOpacity: 0.8\n      });\n      setDirectionsPolyline(polyline);\n\n      // 출발지와 도착지 마커 추가\n      const newMarkers = [];\n\n      // 출발지 마커\n      const startMarker = new window.naver.maps.Marker({\n        position: new window.naver.maps.LatLng(start_location.y, start_location.x),\n        map: mapInstanceRef.current,\n        icon: {\n          content: '<div class=\"start-location-marker\">출발</div>',\n          anchor: new window.naver.maps.Point(15, 30)\n        },\n        title: start_location.name\n      });\n      newMarkers.push(startMarker);\n\n      // 출발지 정보창\n      const startInfoWindow = new window.naver.maps.InfoWindow({\n        content: `\n          <div class=\"info-window\">\n            <h3>출발: ${start_location.name}</h3>\n            <p>${start_location.address}</p>\n          </div>\n        `,\n        maxWidth: 300,\n        backgroundColor: \"#fff\",\n        borderColor: \"#5347AA\",\n        borderWidth: 2\n      });\n      startInfoWindow.open(mapInstanceRef.current, startMarker);\n\n      // 도착지 마커\n      const endMarker = new window.naver.maps.Marker({\n        position: new window.naver.maps.LatLng(end_location.y, end_location.x),\n        map: mapInstanceRef.current,\n        icon: {\n          content: '<div class=\"end-location-marker\">도착</div>',\n          anchor: new window.naver.maps.Point(15, 30)\n        },\n        title: end_location.name\n      });\n      newMarkers.push(endMarker);\n\n      // 도착지 정보창\n      const endInfoWindow = new window.naver.maps.InfoWindow({\n        content: `\n          <div class=\"info-window\">\n            <h3>도착: ${end_location.name}</h3>\n            <p>${end_location.address}</p>\n          </div>\n        `,\n        maxWidth: 300,\n        backgroundColor: \"#fff\",\n        borderColor: \"#5347AA\",\n        borderWidth: 2\n      });\n      endInfoWindow.open(mapInstanceRef.current, endMarker);\n      setDirectionsMarkers(newMarkers);\n\n      // 경로 전체가 보이도록 지도 영역 조정\n      const bounds = new window.naver.maps.LatLngBounds();\n      path.forEach(coord => bounds.extend(coord));\n      mapInstanceRef.current.fitBounds(bounds);\n    }\n  }, [clearDirections]);\n\n  // 길찾기 검색 처리 함수 추가\n  const handleDirectionsSearch = useCallback(async (start, end) => {\n    try {\n      setStartPoint(start);\n      setEndPoint(end);\n\n      // 기존 경로 초기화\n      clearDirections();\n\n      // 길찾기 API 호출 (백엔드로 요청)\n      const response = await fetch('/api/directions', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n        // GET 요청으로 변경했으므로 URL 파라미터 사용\n        // api/directions?start={start}&goal={end}\n      }).then(res => {\n        // URL을 직접 구성\n        const url = `/api/directions?start=${encodeURIComponent(start)}&goal=${encodeURIComponent(end)}`;\n        return fetch(url);\n      });\n      if (!response.ok) {\n        throw new Error('길찾기 검색에 실패했습니다.');\n      }\n      const directionsData = await response.json();\n\n      // 경로 정보가 있는지 확인\n      if (directionsData.code === 0 && directionsData.route) {\n        // 결과 데이터 구조 변환 (NaverMap 컴포넌트에서 사용하는 형식으로)\n        const formattedData = {\n          directions: directionsData,\n          start_location: {\n            name: '출발지',\n            address: start,\n            x: start.split(',')[0],\n            y: start.split(',')[1]\n          },\n          end_location: {\n            name: '도착지',\n            address: end,\n            x: end.split(',')[0],\n            y: end.split(',')[1]\n          }\n        };\n        setDirections(directionsData);\n        setShowDirectionsPanel(true);\n        displayDirections(formattedData);\n      } else {\n        throw new Error(directionsData.message || '경로를 찾을 수 없습니다.');\n      }\n    } catch (error) {\n      console.error('길찾기 검색 중 오류:', error);\n      alert(error.message || '길찾기 검색 중 오류가 발생했습니다.');\n    }\n  }, [clearDirections, displayDirections]);\n\n  // 길찾기 패널 닫기 함수 추가\n  const handleCloseDirections = useCallback(() => {\n    clearDirections();\n    setShowDirectionsPanel(false);\n    setDirections(null);\n  }, [clearDirections]);\n\n  // 초기 맵 로드\n  useEffect(() => {\n    const script = document.createElement('script');\n    script.src = `https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=07gq168p3y`;\n    script.async = true;\n    script.onload = () => {\n      try {\n        // 스크립트가 로드된 후 초기화\n        if (window.naver && window.naver.maps) {\n          const mapOptions = {\n            center: new window.naver.maps.LatLng(37.3595704, 127.105399),\n            zoom: 15,\n            zoomControl: true,\n            zoomControlOptions: {\n              position: window.naver.maps.Position.TOP_RIGHT\n            }\n          };\n          mapInstanceRef.current = new window.naver.maps.Map(mapRef.current, mapOptions);\n          setMapLoaded(true);\n          console.log(\"네이버 지도가 성공적으로 로드되었습니다.\");\n        } else {\n          console.error(\"네이버 지도 API가 로드되지 않았습니다.\");\n          setMapError(\"지도를 로드할 수 없습니다.\");\n        }\n      } catch (error) {\n        console.error(\"지도 초기화 중 오류:\", error);\n        setMapError(\"지도 초기화 중 오류가 발생했습니다.\");\n      }\n    };\n    script.onerror = e => {\n      console.error(\"네이버 지도 스크립트 로드 실패:\", e);\n      setMapError(\"지도 스크립트를 로드할 수 없습니다. API 키를 확인하세요.\");\n    };\n    document.head.appendChild(script);\n    return () => {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n    };\n  }, []);\n\n  // 사용자 위치 변경 시 지도 업데이트\n  useEffect(() => {\n    if (mapLoaded && userLocation) {\n      updateUserLocationMarker();\n    }\n  }, [mapLoaded, userLocation, updateUserLocationMarker]);\n\n  // 검색 결과 변경 시 지도 업데이트\n  useEffect(() => {\n    if (mapLoaded && searchResult) {\n      updateMapWithSearchResult();\n    }\n  }, [mapLoaded, searchResult, updateMapWithSearchResult]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      className: \"naver-map\",\n      id: \"map\",\n      children: [!searchResult && !userLocation && !mapError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"map-instructions\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\uB124\\uC774\\uBC84 \\uC9C0\\uB3C4 \\uAC80\\uC0C9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uC624\\uB978\\uCABD \\uCC44\\uD305\\uCC3D\\uC5D0 \\uC7A5\\uC18C \\uC774\\uB984\\uC774\\uB098 \\uC8FC\\uC18C\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uC704\\uCE58 \\uAE30\\uBC18 \\uAC80\\uC0C9\\uC744 \\uC704\\uD574 \\uC704\\uCE58 \\uC815\\uBCF4 \\uACF5\\uC720\\uB97C \\uD5C8\\uC6A9\\uD574\\uC8FC\\uC138\\uC694\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 11\n      }, this), mapError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-error-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"map-error\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\uC9C0\\uB3C4 \\uB85C\\uB4DC \\uC624\\uB958\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: mapError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"directions-container\",\n      children: /*#__PURE__*/_jsxDEV(DirectionsSearch, {\n        onSearch: handleDirectionsSearch,\n        userLocation: userLocation\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }, this), showDirectionsPanel && directions && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"directions-panel\",\n      children: /*#__PURE__*/_jsxDEV(DirectionsResult, {\n        directions: directions,\n        onClose: handleCloseDirections\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 358,\n    columnNumber: 5\n  }, this);\n};\n_s(NaverMap, \"iaoX0vGm+niwVFAuB5Rd+b2H7BM=\");\n_c = NaverMap;\nexport default NaverMap;\nvar _c;\n$RefreshReg$(_c, \"NaverMap\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","DirectionsSearch","DirectionsResult","jsxDEV","_jsxDEV","NaverMap","searchResult","userLocation","_s","mapRef","mapInstanceRef","markerRef","userMarkerRef","mapLoaded","setMapLoaded","mapError","setMapError","directions","setDirections","directionsPolyline","setDirectionsPolyline","showDirectionsPanel","setShowDirectionsPanel","directionsMarkers","setDirectionsMarkers","startPoint","setStartPoint","endPoint","setEndPoint","polylineRef","updateUserLocationMarker","current","position","window","naver","maps","LatLng","lat","lng","setMap","Marker","map","icon","content","anchor","Point","title","setCenter","setZoom","clearDirections","forEach","marker","updateMapWithSearchResult","status","displayDirections","x","y","address","query","additionalInfo","infoWindow","InfoWindow","maxWidth","backgroundColor","borderColor","borderWidth","anchorSize","Size","anchorColor","pixelOffset","Event","addListener","getMap","close","open","result","route","start_location","end_location","traoptimal","pathCoordinates","path","coord","polyline","Polyline","strokeColor","strokeWeight","strokeOpacity","newMarkers","startMarker","name","push","startInfoWindow","endMarker","endInfoWindow","bounds","LatLngBounds","extend","fitBounds","handleDirectionsSearch","start","end","response","fetch","method","headers","then","res","url","encodeURIComponent","ok","Error","directionsData","json","code","formattedData","split","message","error","console","alert","handleCloseDirections","script","document","createElement","src","async","onload","mapOptions","center","zoom","zoomControl","zoomControlOptions","Position","TOP_RIGHT","Map","log","onerror","e","head","appendChild","parentNode","removeChild","className","children","ref","id","fileName","_jsxFileName","lineNumber","columnNumber","onSearch","onClose","_c","$RefreshReg$"],"sources":["C:/Users/haenee/Desktop/naver-map-chat/frontend/src/components/NaverMap.js"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport './NaverMap.css';\r\nimport DirectionsSearch from './DirectionsSearch';\r\nimport DirectionsResult from './DirectionsResult';\r\nimport './DirectionsSearch.css';\r\nimport './DirectionsResult.css';\r\n\r\nconst NaverMap = ({ searchResult, userLocation }) => {\r\n  const mapRef = useRef(null);\r\n  const mapInstanceRef = useRef(null);\r\n  const markerRef = useRef(null);\r\n  const userMarkerRef = useRef(null);\r\n  const [mapLoaded, setMapLoaded] = useState(false);\r\n  const [mapError, setMapError] = useState(null);\r\n  \r\n  // 길찾기 관련 상태\r\n  const [directions, setDirections] = useState(null);\r\n  const [directionsPolyline, setDirectionsPolyline] = useState(null);\r\n  const [showDirectionsPanel, setShowDirectionsPanel] = useState(false);\r\n  const [directionsMarkers, setDirectionsMarkers] = useState([]);\r\n  const [startPoint, setStartPoint] = useState(null);\r\n  const [endPoint, setEndPoint] = useState(null);\r\n  const polylineRef = useRef(null);\r\n\r\n  // 사용자 위치 마커 업데이트\r\n  const updateUserLocationMarker = useCallback(() => {\r\n    if (!mapInstanceRef.current || !userLocation) return;\r\n    \r\n    const position = new window.naver.maps.LatLng(userLocation.lat, userLocation.lng);\r\n    \r\n    // 이전 사용자 위치 마커 제거\r\n    if (userMarkerRef.current) {\r\n      userMarkerRef.current.setMap(null);\r\n    }\r\n    \r\n    // 사용자 위치 마커 생성\r\n    userMarkerRef.current = new window.naver.maps.Marker({\r\n      position,\r\n      map: mapInstanceRef.current,\r\n      icon: {\r\n        content: '<div class=\"user-location-marker\"></div>',\r\n        anchor: new window.naver.maps.Point(15, 15)\r\n      },\r\n      title: '내 위치'\r\n    });\r\n    \r\n    // 검색 결과가 없을 때만 사용자 위치로 지도 이동\r\n    if (!searchResult && !showDirectionsPanel) {\r\n      mapInstanceRef.current.setCenter(position);\r\n      mapInstanceRef.current.setZoom(16);\r\n    }\r\n  }, [userLocation, searchResult, showDirectionsPanel]);\r\n\r\n  // 경로 지우기\r\n  const clearDirections = useCallback(() => {\r\n    if (directionsPolyline) {\r\n      directionsPolyline.setMap(null);\r\n      setDirectionsPolyline(null);\r\n    }\r\n    \r\n    directionsMarkers.forEach(marker => {\r\n      marker.setMap(null);\r\n    });\r\n    setDirectionsMarkers([]);\r\n  }, [directionsPolyline, directionsMarkers]);\r\n\r\n  // 지도 결과 업데이트 함수\r\n  const updateMapWithSearchResult = useCallback(() => {\r\n    if (!searchResult || !mapInstanceRef.current) return;\r\n\r\n    // 기존 길찾기 정보 제거\r\n    clearDirections();\r\n\r\n    // 길찾기 결과인 경우\r\n    if (searchResult.status === 'DIRECTIONS_RESULT' && searchResult.directions) {\r\n      displayDirections(searchResult);\r\n      return;\r\n    }\r\n\r\n    // 일반 검색 결과 처리 (기존 코드)\r\n    const { x, y, address, query, additionalInfo } = searchResult;\r\n    if (!x || !y) return;\r\n    \r\n    const position = new window.naver.maps.LatLng(y, x);\r\n    \r\n    // 지도 중심 이동\r\n    mapInstanceRef.current.setCenter(position);\r\n    mapInstanceRef.current.setZoom(16);\r\n\r\n    // 이전 마커 제거\r\n    if (markerRef.current) {\r\n      markerRef.current.setMap(null);\r\n    }\r\n\r\n    // 새 마커 생성\r\n    markerRef.current = new window.naver.maps.Marker({\r\n      position,\r\n      map: mapInstanceRef.current,\r\n      title: query\r\n    });\r\n\r\n    // 정보 창 생성\r\n    const infoWindow = new window.naver.maps.InfoWindow({\r\n      content: `\r\n        <div class=\"info-window\">\r\n          <h3>${query}</h3>\r\n          <p>${address}</p>\r\n          ${additionalInfo ? `\r\n            <div class=\"additional-info\">\r\n              <p class=\"info-title\">추가 정보</p>\r\n              <p class=\"info-content\">${additionalInfo}</p>\r\n            </div>\r\n          ` : ''}\r\n        </div>\r\n      `,\r\n      maxWidth: 300,\r\n      backgroundColor: \"#fff\",\r\n      borderColor: \"#5347AA\",\r\n      borderWidth: 2,\r\n      anchorSize: new window.naver.maps.Size(10, 10),\r\n      anchorColor: \"#fff\",\r\n      pixelOffset: new window.naver.maps.Point(10, -10)\r\n    });\r\n\r\n    // 마커 클릭 시 정보 창 표시\r\n    window.naver.maps.Event.addListener(markerRef.current, 'click', () => {\r\n      if (infoWindow.getMap()) {\r\n        infoWindow.close();\r\n      } else {\r\n        infoWindow.open(mapInstanceRef.current, markerRef.current);\r\n      }\r\n    });\r\n\r\n    // 정보 창 자동 표시\r\n    infoWindow.open(mapInstanceRef.current, markerRef.current);\r\n  }, [searchResult, clearDirections]);\r\n\r\n  // 길찾기 결과 표시\r\n  const displayDirections = useCallback((result) => {\r\n    if (!mapInstanceRef.current || !result.directions || !result.directions.route) return;\r\n    \r\n    const { directions, start_location, end_location } = result;\r\n    \r\n    // 경로가 있는지 확인\r\n    if (directions.route && directions.route.traoptimal && directions.route.traoptimal[0]) {\r\n      const pathCoordinates = directions.route.traoptimal[0].path;\r\n      \r\n      // 기존 경로 제거\r\n      clearDirections();\r\n      \r\n      // 새 경로 그리기\r\n      const path = pathCoordinates.map(coord => \r\n        new window.naver.maps.LatLng(coord[1], coord[0]));\r\n      const polyline = new window.naver.maps.Polyline({\r\n        map: mapInstanceRef.current,\r\n        path: path,\r\n        strokeColor: '#5347AA',\r\n        strokeWeight: 5,\r\n        strokeOpacity: 0.8\r\n      });\r\n      \r\n      setDirectionsPolyline(polyline);\r\n      \r\n      // 출발지와 도착지 마커 추가\r\n      const newMarkers = [];\r\n      \r\n      // 출발지 마커\r\n      const startMarker = new window.naver.maps.Marker({\r\n        position: new window.naver.maps.LatLng(start_location.y, start_location.x),\r\n        map: mapInstanceRef.current,\r\n        icon: {\r\n          content: '<div class=\"start-location-marker\">출발</div>',\r\n          anchor: new window.naver.maps.Point(15, 30)\r\n        },\r\n        title: start_location.name\r\n      });\r\n      newMarkers.push(startMarker);\r\n      \r\n      // 출발지 정보창\r\n      const startInfoWindow = new window.naver.maps.InfoWindow({\r\n        content: `\r\n          <div class=\"info-window\">\r\n            <h3>출발: ${start_location.name}</h3>\r\n            <p>${start_location.address}</p>\r\n          </div>\r\n        `,\r\n        maxWidth: 300,\r\n        backgroundColor: \"#fff\",\r\n        borderColor: \"#5347AA\",\r\n        borderWidth: 2\r\n      });\r\n      startInfoWindow.open(mapInstanceRef.current, startMarker);\r\n      \r\n      // 도착지 마커\r\n      const endMarker = new window.naver.maps.Marker({\r\n        position: new window.naver.maps.LatLng(end_location.y, end_location.x),\r\n        map: mapInstanceRef.current,\r\n        icon: {\r\n          content: '<div class=\"end-location-marker\">도착</div>',\r\n          anchor: new window.naver.maps.Point(15, 30)\r\n        },\r\n        title: end_location.name\r\n      });\r\n      newMarkers.push(endMarker);\r\n      \r\n      // 도착지 정보창\r\n      const endInfoWindow = new window.naver.maps.InfoWindow({\r\n        content: `\r\n          <div class=\"info-window\">\r\n            <h3>도착: ${end_location.name}</h3>\r\n            <p>${end_location.address}</p>\r\n          </div>\r\n        `,\r\n        maxWidth: 300,\r\n        backgroundColor: \"#fff\",\r\n        borderColor: \"#5347AA\",\r\n        borderWidth: 2\r\n      });\r\n      endInfoWindow.open(mapInstanceRef.current, endMarker);\r\n      \r\n      setDirectionsMarkers(newMarkers);\r\n      \r\n      // 경로 전체가 보이도록 지도 영역 조정\r\n      const bounds = new window.naver.maps.LatLngBounds();\r\n      path.forEach(coord => bounds.extend(coord));\r\n      mapInstanceRef.current.fitBounds(bounds);\r\n    }\r\n  }, [clearDirections]);\r\n\r\n  // 길찾기 검색 처리 함수 추가\r\n  const handleDirectionsSearch = useCallback(async (start, end) => {\r\n    try {\r\n      setStartPoint(start);\r\n      setEndPoint(end);\r\n      \r\n      // 기존 경로 초기화\r\n      clearDirections();\r\n      \r\n      // 길찾기 API 호출 (백엔드로 요청)\r\n      const response = await fetch('/api/directions', {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        // GET 요청으로 변경했으므로 URL 파라미터 사용\r\n        // api/directions?start={start}&goal={end}\r\n      }).then(res => {\r\n        // URL을 직접 구성\r\n        const url = `/api/directions?start=${encodeURIComponent(start)}&goal=${encodeURIComponent(end)}`;\r\n        return fetch(url);\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('길찾기 검색에 실패했습니다.');\r\n      }\r\n\r\n      const directionsData = await response.json();\r\n      \r\n      // 경로 정보가 있는지 확인\r\n      if (directionsData.code === 0 && directionsData.route) {\r\n        // 결과 데이터 구조 변환 (NaverMap 컴포넌트에서 사용하는 형식으로)\r\n        const formattedData = {\r\n          directions: directionsData,\r\n          start_location: {\r\n            name: '출발지',\r\n            address: start,\r\n            x: start.split(',')[0],\r\n            y: start.split(',')[1]\r\n          },\r\n          end_location: {\r\n            name: '도착지',\r\n            address: end,\r\n            x: end.split(',')[0],\r\n            y: end.split(',')[1]\r\n          }\r\n        };\r\n        \r\n        setDirections(directionsData);\r\n        setShowDirectionsPanel(true);\r\n        displayDirections(formattedData);\r\n      } else {\r\n        throw new Error(directionsData.message || '경로를 찾을 수 없습니다.');\r\n      }\r\n    } catch (error) {\r\n      console.error('길찾기 검색 중 오류:', error);\r\n      alert(error.message || '길찾기 검색 중 오류가 발생했습니다.');\r\n    }\r\n  }, [clearDirections, displayDirections]);\r\n\r\n  // 길찾기 패널 닫기 함수 추가\r\n  const handleCloseDirections = useCallback(() => {\r\n    clearDirections();\r\n    setShowDirectionsPanel(false);\r\n    setDirections(null);\r\n  }, [clearDirections]);\r\n\r\n  // 초기 맵 로드\r\n  useEffect(() => {\r\n    const script = document.createElement('script');\r\n    script.src = `https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=07gq168p3y`;\r\n    script.async = true;\r\n    \r\n    script.onload = () => {\r\n      try {\r\n        // 스크립트가 로드된 후 초기화\r\n        if (window.naver && window.naver.maps) {\r\n          const mapOptions = {\r\n            center: new window.naver.maps.LatLng(37.3595704, 127.105399),\r\n            zoom: 15,\r\n            zoomControl: true,\r\n            zoomControlOptions: {\r\n              position: window.naver.maps.Position.TOP_RIGHT\r\n            }\r\n          };\r\n\r\n          mapInstanceRef.current = new window.naver.maps.Map(mapRef.current, mapOptions);\r\n          setMapLoaded(true);\r\n          console.log(\"네이버 지도가 성공적으로 로드되었습니다.\");\r\n        } else {\r\n          console.error(\"네이버 지도 API가 로드되지 않았습니다.\");\r\n          setMapError(\"지도를 로드할 수 없습니다.\");\r\n        }\r\n      } catch (error) {\r\n        console.error(\"지도 초기화 중 오류:\", error);\r\n        setMapError(\"지도 초기화 중 오류가 발생했습니다.\");\r\n      }\r\n    };\r\n    \r\n    script.onerror = (e) => {\r\n      console.error(\"네이버 지도 스크립트 로드 실패:\", e);\r\n      setMapError(\"지도 스크립트를 로드할 수 없습니다. API 키를 확인하세요.\");\r\n    };\r\n    \r\n    document.head.appendChild(script);\r\n\r\n    return () => {\r\n      if (script.parentNode) {\r\n        script.parentNode.removeChild(script);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // 사용자 위치 변경 시 지도 업데이트\r\n  useEffect(() => {\r\n    if (mapLoaded && userLocation) {\r\n      updateUserLocationMarker();\r\n    }\r\n  }, [mapLoaded, userLocation, updateUserLocationMarker]);\r\n\r\n  // 검색 결과 변경 시 지도 업데이트\r\n  useEffect(() => {\r\n    if (mapLoaded && searchResult) {\r\n      updateMapWithSearchResult();\r\n    }\r\n  }, [mapLoaded, searchResult, updateMapWithSearchResult]);\r\n\r\n  return (\r\n    <div className=\"map-container\">\r\n      <div ref={mapRef} className=\"naver-map\" id=\"map\">\r\n        {!searchResult && !userLocation && !mapError && (\r\n          <div className=\"map-overlay\">\r\n            <div className=\"map-instructions\">\r\n              <h2>네이버 지도 검색</h2>\r\n              <p>오른쪽 채팅창에 장소 이름이나 주소를 입력하세요</p>\r\n              <p>위치 기반 검색을 위해 위치 정보 공유를 허용해주세요</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {mapError && (\r\n          <div className=\"map-error-overlay\">\r\n            <div className=\"map-error\">\r\n              <h2>지도 로드 오류</h2>\r\n              <p>{mapError}</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      <div className=\"directions-container\">\r\n        <DirectionsSearch \r\n          onSearch={handleDirectionsSearch} \r\n          userLocation={userLocation}\r\n        />\r\n      </div>\r\n      \r\n      {showDirectionsPanel && directions && (\r\n        <div className=\"directions-panel\">\r\n          <DirectionsResult \r\n            directions={directions} \r\n            onClose={handleCloseDirections}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NaverMap; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}